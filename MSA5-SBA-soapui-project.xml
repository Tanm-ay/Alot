<?xml version="1.0" encoding="UTF-8"?>
<con:soapui-project id="adf5d58e-9d80-475d-8ae1-3cd812f1d9bc" activeEnvironment="Default" name="MSA5 SBA" resourceRoot="" soapui-version="5.7.0" xmlns:con="http://eviware.com/soapui/config"><con:settings/><con:interface xsi:type="con:RestService" id="4f3bd81d-e5fa-4d38-9bfc-49af2d39c7dd" wadlVersion="http://wadl.dev.java.net/2009/02" name="https://petstore.swagger.io" type="rest" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:settings/><con:definitionCache/><con:endpoints><con:endpoint>https://petstore.swagger.io</con:endpoint></con:endpoints><con:resource name="V2" path="/v2" id="1dd722a3-2d4b-4947-bff0-31ddae50d595"><con:settings/><con:parameters/><con:method name="V2 1" id="18ef6503-315a-4422-811d-11dd36b38329" method="GET"><con:settings/><con:parameters/><con:request name="Request 1" id="148c59ba-7848-4b2b-a925-7ea719af2bff" mediaType="application/json"><con:settings/><con:endpoint>https://petstore.swagger.io</con:endpoint><con:request/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:request></con:method></con:resource></con:interface><con:testSuite id="c965bd22-f51e-4dd4-b8cc-58490df07066" name="TestSuite User"><con:settings/><con:runType>SEQUENTIAL</con:runType><con:testCase id="c958322c-693f-4139-9cd8-f81f1d24c99c" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="TestCase User" searchProperties="true"><con:settings/><con:testStep type="httprequest" name="GET" id="ebe57674-be1f-4b11-8e6b-5f8372195063"><con:settings/><con:config method="GET" xsi:type="con:HttpRequest" id="04fc2602-8e64-42fb-bfb8-8a956495a750" name="GET" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://petstore.swagger.io/v2/user/Peach</con:endpoint><con:request/><con:assertion type="Valid HTTP Status Codes" id="1d5982d2-e9a1-4954-80ec-b64a1b05fbf5" name="Valid HTTP Status Codes"><con:configuration><codes>200</codes></con:configuration></con:assertion><con:assertion type="Simple Contains" id="3492f730-a31c-4831-b952-8063d8ed5448" name="Contains"><con:configuration><token>${Properties#username}</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:config></con:testStep><con:testStep type="httprequest" name="POST" id="c6341ae4-1077-4fc8-9d65-f9db60182551"><con:settings/><con:config method="POST" xsi:type="con:HttpRequest" id="6d865ee8-3009-4974-9255-f345768e93ee" name="POST" postQueryString="false" mediaType="application/json" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://petstore.swagger.io/v2/user</con:endpoint><con:request>{"id":101,"username":"Leris","firstName":"Tanmay","lastName":"Sharma","email":"thx@mt.com","password":"paaas","phone":"1234512345","userStatus":0}</con:request><con:assertion type="Valid HTTP Status Codes" id="56f3a9ec-5b13-49ab-92d0-2dc1de1534dc" name="Valid HTTP Status Codes"><con:configuration><codes>200</codes></con:configuration></con:assertion><con:assertion type="Simple Contains" id="6800af46-8a5d-45fb-a87f-947518de6a9c" name="Contains"><con:configuration><token>${Properties#id}</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:config></con:testStep><con:testStep type="httprequest" name="PUT" id="c8665afa-0e5e-4f92-8ca0-80b4aae546b2"><con:settings/><con:config method="PUT" xsi:type="con:HttpRequest" id="0d89a0da-551a-4b45-bbf5-a087f2d4cc40" name="PUT" postQueryString="false" mediaType="application/json" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://petstore.swagger.io/v2/user/Peach</con:endpoint><con:request>{"id":101,"username":"Peach","firstName":"Fruit","lastName":"Salad","email":"fruity@guava.com","password":"juice","phone":"0000000000","userStatus":1}</con:request><con:assertion type="Valid HTTP Status Codes" id="c00a00ae-0173-4540-b523-53f7671cc8d2" name="Valid HTTP Status Codes"><con:configuration><codes>200</codes></con:configuration></con:assertion><con:assertion type="Simple Contains" id="42f5e649-42b1-4f4b-8f32-c4877c785f6d" name="Contains"><con:configuration><token>${Properties#id}</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:config></con:testStep><con:testStep type="httprequest" name="DELETE" id="09501b48-1b38-4d6f-a561-5b90dd88dd94"><con:settings/><con:config method="DELETE" xsi:type="con:HttpRequest" id="0613fde5-c446-421f-a0a5-a78a3649f710" name="DELETE" postQueryString="false" mediaType="application/xml" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://petstore.swagger.io/v2/user/Peach</con:endpoint><con:request/><con:assertion type="Valid HTTP Status Codes" id="285eaa98-b088-4b4a-b9b5-790eac927819" name="Valid HTTP Status Codes"><con:configuration><codes>200</codes></con:configuration></con:assertion><con:assertion type="Simple Contains" id="93cedfdc-748f-4e71-bed0-2686e58ed314" name="Contains"><con:configuration><token>${Properties#username}</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:config></con:testStep><con:testStep type="groovy" name="RunAll" id="d8b1212a-5ee9-4230-bbaa-579c446c9627"><con:settings/><con:config><script>import jxl.*
import groovy.json.JsonSlurper
import groovy.json.JsonOutput

//Excel Transfer

// ${#Project#Resources} = C:\Users\M1089065\Documents   -For my system
String excel = context.expand('${#Project#Resources}')+"\\User Data.xls"
Workbook wb = Workbook.getWorkbook(new File(excel))
Sheet sh = wb.getSheet(0)
for(int i=1;i&lt;sh.getRows();i++)
{
	Cell key = sh.getCell(0,i)
	Cell value = sh.getCell(1,i)
	testRunner.testCase.testSteps["Properties"].setPropertyValue(key.getContents(),value.getContents())
}
def tcUser = testRunner.testCase.testSuite.testCases["TestCase User"]
def getPath = tcUser.testSteps["GET"]
def endGet = context.expand('${#Project#Get}')

def ppObj = /{
  "id": 0,
  "username": "string",
  "firstName": "string",
  "lastName": "string",
  "email": "string",
  "password": "string",
  "phone": "string",
  "userStatus": 0
}/

//POST
def unName = context.expand('${Properties#username}')
def req = new JsonSlurper().parseText(ppObj)

req.id = context.expand('${Properties#id}').toInteger()
req.username = context.expand('${Properties#username}')
req.firstName = context.expand('${Properties#firstName}')
req.lastName = context.expand('${Properties#lastName}')
req.email = context.expand('${Properties#email}')
req.password = context.expand('${Properties#password}')
req.phone = context.expand('${Properties#phone}')
req.userStatus = context.expand('${Properties#userStatus}').toInteger()

def jString = JsonOutput.toJson(req)
def postPath = tcUser.testSteps["POST"]
def endPost = context.expand('${#Project#Post}')

postPath.setPropertyValue("Endpoint",endPost)
postPath.setPropertyValue("Request",jString)
postPath.run(testRunner,context)
	try
	{	
		def respPost = postPath.getPropertyValue("Response")
		def convPost = new JsonSlurper().parseText(respPost)
		if(convPost.code == 200)
		{	
			log.info " POST operation successful. Created user with username = "+context.expand('${Properties#username}')
		}
		else
		{
			log.error " POST operation unsuccessful.Could not create user with username = "+context.expand('${Properties#username}')
		}
	}
	catch(Exception e)
	{
		log.error " POST operation unsuccessful ["+e.getMessage()+"]"
	}

//GET for POST

getPath.setPropertyValue("Endpoint",endGet+context.expand('${Properties#username}'))
getPath.run(testRunner,context)
	try
	{	
		def respGet = getPath.getPropertyValue("Response")
		def convGet = new JsonSlurper().parseText(respGet)
		if(convGet.username == unName)
		{	
			log.info " GET operation successful. Found user with username = "+context.expand('${Properties#username}')
		}
		else
		{
			log.error " GET  operation unsuccessful. No user found with username = "+context.expand('${Properties#username}')
		}
	}
	catch(Exception e)
	{
		log.error " Get operation unsuccessful ["+e.getMessage()+"]"
	}

//PUT 

def newUsername = "Peach"
context.testCase.testSteps["Properties"].setPropertyValue("username",newUsername)
def putReq = new JsonSlurper().parseText(ppObj)

putReq.id = context.expand('${Properties#id}').toInteger()
putReq.username = newUsername
putReq.firstName = "Fruit"
putReq.lastName = "Salad"
putReq.email = "fruity@guava.com"
putReq.password = "juice"
putReq.phone = "0000000000"
putReq.userStatus = 1

def putString = JsonOutput.toJson(putReq)
def putPath = tcUser.testSteps["PUT"]
def endPut = context.expand('${#Project#Put}')

putPath.setPropertyValue("Endpoint",endPut+newUsername)
putPath.setPropertyValue("Request",putString)
putPath.run(testRunner,context)
	try
	{	
		def respPut = putPath.getPropertyValue("Response")
		def convPut = new JsonSlurper().parseText(respPut)
		if(convPut.code == 200)
		{	
			log.info " PUT operation successful. Updated user with username = "+newUsername
		}
		else
		{
			log.error " PUT operation unsuccessful. Could not find user with username = "+newUsername
		}
	}
	catch(Exception e)
	{
		log.error " PUT operation unsuccessful ["+e.getMessage()+"]"
	}

//GET for PUT

getPath.setPropertyValue("Endpoint",endGet+newUsername)
getPath.run(testRunner,context)
	try
	{	
		def respGet = getPath.getPropertyValue("Response")
		def convGet = new JsonSlurper().parseText(respGet)
		if(convGet.username == newUsername)
		{	
			log.info " GET operation successful. Found user with username = "+newUsername
		}
		else
		{
			log.error " GET  operation unsuccessful. No user found with username = "+newUsername
		}
	}
	catch(Exception e)
	{
		log.error " Get operation unsuccessful ["+e.getMessage()+"]"
	}

//DELETE

def delPath = tcUser.testSteps["DELETE"]
def endDel = context.expand('${#Project#Delete}')

delPath.setPropertyValue("Endpoint",endDel+newUsername)
delPath.run(testRunner,context)
	try
	{	
		def respDel = delPath.getPropertyValue("Response")
		def convDel = new JsonSlurper().parseText(respDel)
		if(convDel.code == 200)
		{	
			log.info " DELETE operation successful. Deleted user with username = "+newUsername
		}
		else
		{
			log.error " DELETE  operation unsuccessful. Could not delete user with username = "+newUsername
		}
	}
	catch(Exception e)
	{
		log.error " DELETE operation unsuccessful ["+e.getMessage()+"]"
	}

//GET for DELETE

getPath.setPropertyValue("Endpoint",endGet+newUsername)
getPath.run(testRunner,context)
	try
	{	
		def respGet = getPath.getPropertyValue("Response")
		def convGet = new JsonSlurper().parseText(respGet)
		if(convGet.username == newUsername)
		{	
			log.info " GET operation successful. Found user with username = "+newUsername
		}
		else
		{
			log.error " GET  operation unsuccessful. No user found with username = "+newUsername
		}
	}
	catch(Exception e)
	{
		log.error " Get operation unsuccessful ["+e.getMessage()+"]"
	}



</script></con:config></con:testStep><con:testStep type="properties" name="Properties" id="0cba18dc-2dd9-48cd-96ee-09e0ad08e067"><con:settings/><con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:properties><con:property><con:name>id</con:name><con:value>101</con:value></con:property><con:property><con:name>username</con:name><con:value>Peach</con:value></con:property><con:property><con:name>firstName</con:name><con:value>Tanmay</con:value></con:property><con:property><con:name>lastName</con:name><con:value>Sharma</con:value></con:property><con:property><con:name>email</con:name><con:value>thx@mt.com</con:value></con:property><con:property><con:name>password</con:name><con:value>paaas</con:value></con:property><con:property><con:name>phone</con:name><con:value>1234512345</con:value></con:property><con:property><con:name>userStatus</con:name><con:value>0</con:value></con:property></con:properties></con:config></con:testStep><con:properties/></con:testCase><con:properties/></con:testSuite><con:properties><con:property><con:name>Get</con:name><con:value>https://petstore.swagger.io/v2/user/</con:value></con:property><con:property><con:name>Post</con:name><con:value>https://petstore.swagger.io/v2/user</con:value></con:property><con:property><con:name>Put</con:name><con:value>https://petstore.swagger.io/v2/user/</con:value></con:property><con:property><con:name>Delete</con:name><con:value>https://petstore.swagger.io/v2/user/</con:value></con:property><con:property><con:name>Resources</con:name><con:value>${projectDir}</con:value></con:property></con:properties><con:wssContainer/><con:oAuth2ProfileContainer/><con:oAuth1ProfileContainer/></con:soapui-project>